version: "3"
services:
  builder:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: 'book-builder'
    volumes:
      - static:/book/output/:/book/
    command: ["mdbook", "build", "-d", "./output/"]

  web-server:
    image: nginx:stable-alpine3.17
    volumes:
      - static:/usr/share/nginx/html/
    ports:
      - "${IP}:80:80"
    restart: always

volumes:
  static:
